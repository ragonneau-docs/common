%% maths.sty
%% Copyright 2023 Tom M. Ragonneau
%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   https://www.latex-project.org/lppl.txt
% and version 1.3c or later is part of all distributions of LaTeX
% version 2008 or later.
%
% This work has the LPPL maintenance status `maintained'.
%
% The Current Maintainer of this work is Tom M. Ragonneau.
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{common/maths}[2023/10/10 v1.0 Mathematical typesetting tools]

% Options
\DeclareOption*{\PackageWarning{maths}{Unknown `\CurrentOption'}}
\ProcessOptions\relax

% Preliminary declarations
\RequirePackage{mathtools}
\RequirePackage{amssymb}
\RequirePackage{amsthm}
\RequirePackage{cases}
\RequirePackage{empheq}
\RequirePackage[bb=dsfontserif]{mathalpha}
\RequirePackage{etoolbox}
\RequirePackage{ifthen}
\RequirePackage{xargs}
\RequirePackage{relsize}

% Equation numbering hierarchy
\@ifclassloaded{manuscript}{\numberwithin{equation}{section}}{}

% Mathematical environments (theorems, proofs, ...)
\@ifclassloaded{manuscript}{
    \theoremstyle{definition}
    \newtheorem{assumption}{Assumption}[section]
    \newtheorem{axiom}{Axiom}[section]
    \newtheorem{condition}{Condition}[section]
    \newtheorem{definition}{Definition}[section]
    \newtheorem{example}{Example}[section]
    \newtheorem{exercise}{Exercise}[section]
    \newtheorem{hypothesis}{Hypothesis}[section]
    \newtheorem{problem}{Problem}[section]
    \newtheorem{property}{Property}[section]
    \newtheorem{question}{Question}[section]
    \theoremstyle{plain}
    \newtheorem{assertion}{Assertion}[section]
    \newtheorem{conjecture}{Conjecture}[section]
    \newtheorem{criterion}{Criterion}[section]
    \newtheorem{lemma}{Lemma}[section]
    \newtheorem{proposition}{Proposition}[section]
    \newtheorem{theorem}{Theorem}[section]
    \newtheorem{corollary}{Corollary}[theorem]
    \theoremstyle{remark}
    \newtheorem*{acknowledgment}{Acknowledgment}
    \newtheorem*{case}{case}
    \newtheorem*{claim}{Claim}
    \newtheorem*{conclusion}{Conclusion}
    \newtheorem*{notation}{Notation}
    \newtheorem*{note}{Note}
    \newtheorem*{remark}{Remark}
    \newtheorem*{summary}{Summary}
}

% Make @ behave as per catcode 13 (active). The TeXbook, p. 155.
\mathcode`@="8000{\catcode`\@=\active\gdef@{\mkern1mu}}

% Operators
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator{\bigo}{\mathcal{O}}
\DeclareMathOperator{\card}{card}
\DeclareMathOperator{\conv}{conv}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\Diag}{Diag}
\DeclareMathOperator{\diam}{diam}
\DeclareMathOperator{\dist}{dist}
\DeclareMathOperator{\grad}{grad}
\DeclareMathOperator{\hess}{Hess}
\DeclareMathOperator{\range}{range}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\smallo}{o}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\var}{var}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\vol}{vol}
\DeclareMathOperator{\vspan}{span}

% Sets
\newcommand*{\C}{\mathbb{C}}
\newcommand*{\F}{\mathbb{F}}
\newcommand*{\N}{\mathbb{N}}
\newcommand*{\Q}{\mathbb{Q}}
\newcommand*{\R}{\mathbb{R}}
\newcommand*{\Z}{\mathbb{Z}}

% Notations
\newcommand*{\du}{\mathrm{d}}
\newcommand*{\E}{\mathbb{E}}
\newcommand*{\eu}{\mathrm{e}}
\newcommand*{\Id}[1][]{I\ifblank{#1}{}{_{#1}}}
\newcommand*{\iu}{\mathrm{i}}
\newcommand*{\ones}{\mathbb{1}}
\newcommand*{\pinv}{\dagger}
\renewcommand*{\Pr}{\mathbb{P}}
\newcommand*{\T}{\mathsf{T}}

% Macros
\newcommand*{\abs}[2][]{#1\lvert#2#1\rvert}
\newcommand*{\ceil}[2][]{#1\lceil#2#1\rceil}
\newcommand*{\floor}[2][]{#1\lfloor#2#1\rfloor}
\newcommand*{\inner}[2][]{#1\langle#2#1\rangle}
\newcommand*{\negative}[2][]{#1[#2#1]^-}
\newcommandx*{\norm}[3][1={},2={}]{#1\lVert#3#1\rVert\ifblank{#2}{}{_{\ifthenelse{\equal{#2}{fro}}{\mathsf{F}}{\ifthenelse{\equal{#2}{nuc}}{\ast}{#2}}}}}
\newcommand*{\positive}[2][]{#1[#2#1]^+}
\newcommand*{\set}[2][]{#1\{#2#1\}}
\newcommand*{\defeq}{\stackrel{\mathsmaller{\mathsf{def}}}{=}}
\newcommand*{\transpose}[1]{#1^{\T}}
